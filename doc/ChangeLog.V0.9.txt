/*
	© 2020 FrankHB.

	This file is part of the YSLib project, and may only be used,
	modified, and distributed under the terms of the YSLib project
	license, LICENSE.TXT.  By continuing to use, modify, or distribute
	this file you indicate that you have read the license and
	understand and accept it fully.
*/

/*!	\file ChangeLog.V0.9.txt
\ingroup Documentation
\brief 版本更新历史记录 - V0.9 。
\version r1311
\author FrankHB <frankhb1989@gmail.com>
\since build 800
\par 创建时间:
	2020-10-12 17:19:23 +0800
\par 修改时间:
	2020-11-30 23:06 +0800
\par 文本编码:
	UTF-8
\par 模块名称:
	Documentation::ChangeLog::'V0.8'
*/

// See %Documentation::Meta for meta descriptions.

$import $HISTORY;

// Scope: [b900, $now];

$now
(
	/ @ "%test.sh" @ %Test $=
	(
		- "%AR",
			// This is now detected automatically in \
				%Tools/SHBuild-common-options.sh.
		/ DLI "shrinked prefixed tabs" @ "default value" @ "%(INCLUDES, LIBS)",
		(
		/ "fixed test directory" ^ '${BASH_SOURCE[0]}' ~ '$0';
		- "overridable %TestDir"
		),
		* $comp "%SHBuild_Debug not effective" $since b575
			$dep_from ("%(CXXFLAGS_OPT_DBG, LDFLAGS_OPT_DBG)"
			@ "%SHBuild-common-options.sh")
	),
	/ %YBase.YStandardEx $=
	(
		/ %YBase.YStandardEx.CStandardIO $=
		(
			+ "2nd parameter to allow file creation" @ "function %fexists" ,
			/ $lib "all 'yonthrow'" @ "functions with narrow contracts on the \
				parameters" -> 'ynothrowv'
				$effective @ "functions %(vfmtlen, setnbuf, fexists)"
		),
		/ DLDI "member function %monotonic_buffer_resource::release"
			@ 'YB_Has_memory_resource != 1' @ %MemoryResource
			^ "%ystdex::aligned_store_cast" ~ 'reinterpret_cast'
	),
	/ %YFramework $=
	(
		+ "2nd parameter to allow file creation" @ "all 2 functions %ufexists"
			@ %YCLib.FileIO,
		+ "function %RandomizeTemplatedString" @ %YSLib.Core.YCoreUtilities,
		/ %NPL $=
		(
			* "wrong check" @ "function template %CheckRegular" $since b855
				/ $= (/ $impl ^ "%IsBranch" ~ "%IsList"),
			(
			/ "function %A1::ThrowInsufficientTermsError" @ %NPLA1
				-> ("%NPL::ThrowInsufficientTermsError with 2 parameters"
				@ %NPLA);
			/ $forced "enhanced exception messages for insufficient terms"
				@ "calls of %ThrowInsufficientTermsError" $effective
				@ ("functions %(BindParameter, MatchParameter)" @ %NPLA1,
				"functions %Forms::(Cond, When, Unless, DefineLazy, \
				'Define*', 'SetWith*', 'Lambda*', 'Vau*', First, FirstVal, \
				'ListAsterisk*', FoldR1, Map1, ForwardListFirst)" @ %NPLA1Forms)
			),
			/ %NPLA1Forms $=
			(
				/ "functions %(Equal, EqualLeaf, EqualReference, EqualValue)"
					=> "%(Eq, EqLeaf, EqReference, EqValue)",
				+ "function %EqualTermValue",
				/ "supported thunked recursive comparison" @ "%operator=="
					@ "encapsulation constructed from function \
					%MakeEncapsulationType"
					~ "type comparison"
			),
			/ %Dependency $=
			(
				/ @ "function %LoadGroundContext" $=
				(
					/ DLDI "order with other applicatives"
						@ "applicatives (%restv, 'rest&', 'rest&')",
						// This is now more consistent to %Documentation.NPL.
					(
					+ "applicatives ('branch?', 'branchv?')";
					+ "applicative 'equal?'" ^ $dep_from "%EqualTermValue"
					)
				),
				+ "applicative %SHBuild_MakeTempFilename"
					@ "function %LoadModule_SHBuild"
					^ $dep_from ("%YSLib::RandomizeTemplatedString"
					@ %YSLib.Core.YCoreUtilities,
					"%ystdex::fexists" @ %YBase.YStandardEx.CStandardIO),
				+ "applicative 'remove-file'"
					@ "function %LoadModule_std_system"
			)
		)
	),
	/ %Tools.Scripts $=
	(
		/ DLDI @ "%SHBuild-YSLib-build.txt" $=
		(
			- "redundant restore of %LIBS before dynamic library building",
			/ "simplified import of 'env-get'"
		),
		/ @ "%SHBuild-BuildApp.txt" $=
		(
			(
			- "exported %(SHBuild_CFLAGS, SHBuild_CXXFLAGS) from %(CFLAGS, \
				CXXFLAGS)";
			* $comp "exported %(SHBuild_CFLAGS, SHBuild_CXXFLAGS) clashed with \
				%(CFLAGS, CXXFLAGS) set in %SHBuild-YSLib-common.txt"
				$since b900
				// This was OK in the original %SHBuild-BuildApp.sh, since \
					the flags were not used in the command line of %SHBuild \
					called in that script.
			),
			+ "support of %(SHBuild_LDFLAGS, SHBuild_LIBS) as the prefix of \
				%(LDFLAGS, LIBS)",
				// Now prefixed extra flags can coexist with the inferred ones \
					from the build script.
			/ @ "help message" $=
			(
				+ "clarification of %SRCPATH in 'SHBOPT_BASE ...'",
				* "wrong description for %SHBuild_Static"
					$orig (@ "%SHBuild-BuildApp.sh" $since b556)
			),
			* "environment variable %SHBuild_Static not respected" $since b900
		),
		/ @ "%SHBuild-common-options.sh" $=
		(
			/ "set %(CXXFLAGS_OPT_DBG, LDFLAGS_OPT_DBG)" @ '%SHBuild_Debug'
				// As %SHBuild-BuildApp.txt and the old %SHBuild-BuildApp.sh.
			/ DLI "shrinked prefixed tabs" @ "all default values",
		),
		/ DLI @ "%SHBuild-bootstrap.sh" $=
		(
			/ "shrinked prefixed tabs" @ "all default values",
			/ $design "quoted arguments" @ "1st call of %SHBuild_Puts"
		),
		/ @ "%SHBuild-common.sh" $=
		(
			/ @ "function %SHBuild_CheckUName" $=
			(
				* "wrong names used to check the initialization" $since b563 $=
				(
					/ "%SHBuild_OS" -> "%SHBuild_Env_OS",
					/ "%SHBuild_Arch" -> "%SHBuild_Env_Arch"
				),
				* "allowed setting variables ignoring irrelavent initialization"
					$since b563
			);
			+ "minimal cross-build toolchain support" $=
			(
				+ "function %SHBuild_PrepareBuild";
				/ "function %SHBuild_CheckHostPlatform"
					^ "%SHBuild_PrepareBuild" ~ "%SHBuild_CheckUName"
			)
		),
		/ @ "%SHBuild-YSLib-common.txt" $=
		(
			/ "optimized away unnecessary initialization when the value \
				of %(CFLAGS, CXXFLAGS) has been already specified externally",
			/ "%LDFLAGS not overridable" $since b796,
			/ DLDI "all dynamic environment variable 'env'" => 'd',
			/ "intialized variables %(SHBuild_Env_OS, SHBuild_Env_Arch) \
				globally as %SHBuild_GetPlatformStrings";
			/ "returned host environment variables" ~ "build environment \
				variables" @ "applicative %SHBuild_GetPlatformStrings";
				// Like %SHBuild_PrepareBuild instead of %SHBuild_CheckUName \
					in %SHBuild-common.sh.
			/ "separated build and host environments"
				@ "applicatives %SHBuild_CheckCXX, 'build-with-conf-opt' and \
					installation routines"
			(
			/ DLDI "simplified use of host NUL and temporary directory \
				without 'env-os'";
			- "applicatives for NUL and temporary directory",
			- "environment OS parameter 'env-os'" @ "applicatives \
				'system-or-puts', 'compile-ok-silent', %(SHBuild_2m, \
				SHBuild_2u, SHBuild_2w, SHBuild_GetTempDir)"
			),
			/ "improved handling of temporary files" $=
			(
				/ "randominzed filename on creation" ^ $dep_from
					("%SHBuild_MakeTempFilename" @ %YFramework.NPL.Dependency),
				/ "deleted files after use"
					^ $dep_from ('remove-file' @ %YFramework.NPL.Dependency)
			)
		),
		(
		/ $forced "separated build and host environments"
			@ "%(SHBuild-BuildApp.txt, SHBuild-YSLib-build.txt)"
			$dep_from ("%SHBuild_GetPlatformStrings"
			@ "%SHBuild-YSLib-common.txt")
			$dep_to "SHBuild build scripts build variables support";
		/ "simplified the use of build environment OS by initialization \
			globally" $effective @ "%(SHBuild-YSLib-common.txt, \
			SHBuild-YSLib-build.txt, SHBuild-BuildApp.txt)"
		)
	),
	/ "supported build variables %(SHBuild_Host_Arch, SHBuild_Host_OS) for \
		build scripts" $=
	(
		/ "call of %SHBuild_CheckUName" -> ($dep_from
			"%SHBuild_PrepareBuild" @ ("%SHBuild-common.sh" @ %Tools.Scripts))
			$effecitive @ ("%install-sysroot.sh", "%(SHBuild-bootstrap.sh, \
			SHBuild-toolchain-options.sh)" @ %Scripts) @ %Tools,
		/ ^ "%(SHBuild_Host_Arch, SHBuild_Host_OS) for host"
			~ "%(SHBuild_Env_Arch, SHBuild_Env_OS)"
			$effective @ "%(SHBuild-self-host.sh, SHBuild-common-options.sh, \
			SHBuild-bootstrap.sh)" @ %Tools.Scripts
		/ $dep_from "SHBuild build scripts build variables support"
	)
),

b903
(
	* "trailing NUL wrongly added to the command" @ "functions \
		%ParseCommandArguments" @ %'YCLib.(Win32)'.MinGW32 $since b901,
	/ %YFramework $=
	(
		/ "function %TraceException" @ %YSLib.Core.YException
			-> "%PrintMessage" $=
		(
			/ DLDI "simplified" !^ "%string",
			/ "function name" @ "exception message"
		),
		/ %NPL $=
		(
			+ "function %TraceException" @ %NPLA,
			+ "function %TraceBacktrace" @ %NPLA1
		)
	),
	/ %Tools $=
	(
		/ %Scripts $=
		(
			/ "adjusted shell variables to avoid the assumption on the Sysroot \
				layout" @ "%SHBuild-BuildPkg.sh" $=
			(
				// See $2020-10 @ %Documentation::Workflow.
				/ "inferred path from external variable %SHBuild";
				+ "external variable %NPLA1_ROOT for inferred path of the \
					NPLA1 root";
				/ "adjusted variable definitions based on the inferred paths"
					~ "%SHBuild_Bin" $dep_to "removal of SHBuild_Bin"
			),
			/ @ "%SHBuild-BuildApp.txt" $=
			(
				* "wrong description of %CONF input argument" @ "usage"
					@ "applicative %SHBuild_PrintUsage"
					$since b900,
				* "wrong %LIB set for static builds" since b900
					$= (/ '-Wl,dn' -> '-Wl,-dn'),
				(
				* "wrong use of %SHBuild_AppBaseDir" @ "SHBuild command line"
					$since b900,
					// This accidentally works for default value '.' when the \
						source is also here. Now %SHBuild-BuildPkg.sh also has \
						to pass the %SRCPATH explicitly.
				/ "%SHBuild_AppBaseDir output" -> "%SHBuild_BuildDir output",
				/ "output directory configured based on %SHBuild_BuildDir"
					$dep_to "applying build directory configuration";
				- "%SHBuild_BuildPrefix"
				- "%SHBuild_AppBaseDir"
				),
				- "%SHBuild_BuildPrefix"
					$dep_from "%SHBuild_BuildDir" @ ("%build-all.sh" @ %YDE),
				/ "quoted configuration names for output",
				/ "trimmed %SHBuild_YSLib_Flags",
				* "flags workaround overriden unexpectedly" $since b900
			),
			/ @ "%SHBuild-BuildPkg.sh" $=
			(
				* "wrong handling of the path for the default value of %SHBuild"
					$since b900,
				* "missing '--' to prevent arguments captured by %SHBuild \
					being called directly" $since b900
			),
			/ "removed build functionality" @ "%SHBuild-BuildApp.sh"
				($dep_from "removal of SHBuild_Bin",
				$dep_all_from "removing use of SHBuild-BuildApp.sh"),
				// See $2020-10 @ %Documentation::Workflow.
			/ @ "%SHBuild-YSLib-common.txt" $=
			(
				/ @ "%AR detection" $=
				(
					* "wrong command constructed" $since b902,
					/ DLI "enhanced command 'ar' with %SHBuild_2m conversion"
				),
				/ DLDI "simplified %SHBuild_TrimOptions_ calls"
					@ "setting %LDFLAGS",
				/ "trimmed %SHBOPT" ^ "%SHBuild_TrimOptions"
			),
			- "variable %SHBuild_AppBaseDir"
				@ "%(SHBuild-common-options.sh, SHBuild-common-toolchain.sh)",
			+ 'set -e' @ "%(PatchRevision.sh, GenerateProject.sh, \
				SHBuild-BuildPkg.sh)"
				// Also to prevent ShellCheck warning: SC2164.
			/ @ "%SHBuild-bootstrap.sh" $=
			(
				/ "'true' and ShellCheck directives for SC2164" -> 'set -e',
				+ "%SHBuild_CheckHostPlatform call",
					// This is explicitly lifted so the client scripts can use \
						nonempty %SHBuild_Host_Platform despite of \
						%SHBuild_BuildDir.
				/ "%SHBuild_BuildDir" $=
				(
					/ "exposed overridable variable",
					/ "default value" -> "stage 1 default build directory"
				)
			),
			/ "ShellCheck directive for SC2164"
				@ "%(SHBuild-common-toolchain.sh, SHBuild-common-optionsl.sh)"
				-> 'set -e',
			/ @ "%(SHBuild-self-host.sh, SHBuild-self-host-DLL.sh)" $=
			(
				/ DLI "simplified output directory initialization"
					$dep_from ("%SHBuild_BuildDir" @ "%SHBuild-bootstrap.sh")
					 $= (- "%SHBuild_BuildDir"),
				/ "build subdirectory"
					// To avoid mixture to other build libraries in normal \
						SHBuild stages.
			),
			/ "worked around to disable LTO" @ "%platform %MinGW32"
				@ "%SHBuild-self-host.sh",
				// This resolves the allocation failure due to limited address \
					space in linking with %MinGW32 host toolchain. Even \
					without this issue, it would still choke with LTO like \
					other builds in MinGW32 release static configuration.
			/ @ "%SHBuild-YSLib-build.sh" $=
			(
				/ "loading external unit"
					^ "%SHBuild_ToolDir" ~ "%SHBuild_Common",
				(
				/ "all %YSLib_BuildDir" -> "%SHBuild_BuildDir";
				/ "stage 2 build directory" -> "subdirectory '.shbuild-dll' of \
					directory specified by %SHBuild_BuildDir"
					$dep_from "build subdirectory" @ "%SHBuild-self-host-DLL.sh"
					// The new location is the old location for self-hosted \
						package of %SHBuild. The old location is in the \
						Sysroot and there is no way to make the directories \
						for different hosts coexist by default, so it is not \
						friendly to package.
				),
				/ DLDI "simplified library output directory construction",
				/ DLDI "simplified library installation",
				* "wrong skipping description output" @ 'SHBuild_NoDynamic'
					$since b838
			)
		),
		/ @ "%install-sysroot.sh" $=
		(
			/ DLDI "simplified script call" !^ "%SHBuild_Common"
				$dep_from ("loading external unit" @ "%SHBuild-YSLib-build.sh"),
			(
			- "passing %AR to the script call";
				// This is for stage 2.
			- "variable %AR"
				// This is then for stage 1.
			),
			(
			/ "all use of %YSLib_Build" -> "%SHBuild_BuildDir";
			- "%YSLib_BuildDir" $dep_from "%YSLib_BuildDir"
				@ "%SHBuild-YSLib-build.sh"
			)
		),
		/ %SHBuild $=
		(
			/ %Main $=
			(
				* $comp "truncated quoted command name shown" @ "usage"
					@ "help message" @ "platform %Win32" $since b901
					$dep_from %'YCLib.(Win32)'.MinGW32,
				/ "trimmed options of flags",
					// This eliminates whitespaces after the '-c' compiler \
						option when the flag (e.g. %SHBuild_CXXFLAGS) is empty.
				/ "NPL unit interpretion" $=
				(
					/ "name of NPL unit from standard input"
						-> '*STDIN*' ~ '<stdin>',
					(
					/ "loading source by rewriting and rethrowing of exceptions"
						~ "%TryLoadSource";
					/ "traced source location on NPLA1 exception",
					+ "optional trace for backtrace output at %General log \
						group for NPLA1 exceptions controlled by external \
						%SHBuild_NoBacktrace macro (undefined by default)"
						^ $dep_from ("%TraceException" @ %YFramework.NPL.NPLA,
						"%TraceBacktrace" @ %YFramework.NPL.NPLA1)
					)
				)
			),
			/ $doc "%Readme.en-US.txt" -> "%Readme.en-US.md"
		)
	),
	/ @ "%SHBuild-YSTest.sh" @ %YSTest $=
	(
		// See $2020-11 @ %Documentation::Workflow.
		(
		/ "located other scripts" ^ "possibly overriden %SHBuild location";
		+ "external variable %NPLA1_ROOT for inferred path of the NPLA1 root"
		),
		(
		- $revert_ex(b902) "support of overriding %SHBuild_SysRoot",
			// %SHBuild_SysRoot is documented to specify the output directory. \
				For input, %SHBuild can be specified directly now.
		* "wrong default value" @ "%SHBuild_AppBaseDir" $since b549
			'${BASH_SOURCE[0]}' ~ '$0'
		/ DLDI "simplified" ^ $dep_from "%SHBuild-BuildPkg.sh"
			~ "%SHBuild-BuildApp.sh"
			$dep_from ("removal of SHBuild_Bin", "SHBuild_AppBaseDir passing")
			$dep_to "removing use of SHBuild-BuildApp.sh";
		^ "%SHBuild_BuildDir" ~ "%SHBuild_AppBaseDir",
		(
		+ "check for missing arguments before 'mkdir -p'";
		/ $comp "required configuration name argument without '-c' prefix"
			// This is a breaking change.
		)
		),
		- DLI "output directory creation"
			// This should be the same because %SHBuild would create the \
				directory if not already existed.
	),
	- "undocumented %SHBuild_Bin" $effective @ ("%(SHBuild-BuildPkg.sh, \
		GenerateProject.sh, PatchRevision.sh)" @ %Tools.Scripts,
		"%SHBuild-YSTest.sh" @ %YSTest) $dep_from "removal of SHBuild_Bin",
		// See $2020-10 @ %Documentation::Workflow.
	/ "%test.sh" @ %Test $=
	(
		/ DLI "shell subcommand calls" ^ "$(...)" ~ "legacy `...`",
			// Also to eliminate ShellCheck issue: SC2006.
		* "missing quotes on default values for assignments" $since b575,
			// Also to eliminate ShellCheck issue: SC2223.
		* "missing quotes on the result of %dirname command as command or \
			argument" $since b575,
			// Also to eliminate ShellCheck warning: SC2046.
		+ DLD "ShellCheck directive for %(CXXFLAGS_OPT_UseAssert, \
			SHBuild_Debug, SHBuild_NoAdjustSubsystem)",
			// To eliminate ShellCheck warning: SC2034.
		- "redundant single quotes" @ "default value" @ "variable %AR",
		+ DLD "ShellCheck directive for souce inclusions",
			// To eliminate ShellCheck warning SC1090. Note this relies on \
				'shellcheck -x -P SCRIPTDIR', or there is issue SC1091.
		* "missing quotes on the 'mkdir' and 'SHBuild_Pushd' arguments"
			$since b740,
			// Also to eliminate ShellCheck issue: SC2086.
		+ DLD "ShellCheck directive on the last command",
			// To eliminate ShellCheck issue SC2086 and warning SC2154.
		+ DLD "ShellCheck directive for %SHBuild_Host_Platform",
			// To eliminate ShellCheck warning: SC2154.
		/ DLI ^ "%SHBuild-common-options" ~ "%SHBuild-BuildApp.sh"
			 $dep_to "removing use of SHBuild-BuildApp.sh",
			 // There is no need to call %SHBuild here.
	),
	/ @ "%build-all.sh" @ %YDE $=
	(
		(
		/ "located other scripts" ^ "possibly overriden %SHBuild location";
		+ "external variable %NPLA1_ROOT for inferred path of the NPLA1 root"
		),
		/ DLI "simplified" ^ "%SHBuild-BuildPkg.sh" ~ "%SHBuild-BuildApp.sh"
			$dep_to "removing use of SHBuild-BuildApp.sh",
			// This is a bit inefficitent because the configuration is not used.
		/ DLI "shell subcommand calls" ^ "$(...)" ~ "legacy `...`",
			// Also to eliminate ShellCheck issue: SC2006.
		* "missing quotes on default values for assignments" $since b556,
			// Also to eliminate ShellCheck issue: SC2223.
		+ DLD "ShellCheck directive for souce inclusions",
			// To eliminate ShellCheck warning SC1091.
		(
		* "missing quotes on '$SHBuild_ThisDir' and the 'echo' arguments"
			$since b556;
			// Also to eliminate ShellCheck issue: SC2086.
		/ DLI ^ 'SHBuild_Puts' ~ 'echo'
		),
		/ "%SHBuild_BuildPrefix" -> "%SHBuild_BuildDir"
			$dep_from "applying build directory configuration",
		/ "wrapped package path for %SHBuild_Puts with %SHBuild_2m"
	),
	/ DLI "'echo Done.' where %SHBuild_Puts is available"
		-> "SHBuild_Puts 'Done.'" $effective @ ("%test.sh" @ %Test,
		"%SHBuild-YSTest.sh" @ %YSTest, "%build-all.sh" @ %YDE,
		"%(SHBuild-self-host.sh, SHBuild-self-host-DLL.sh)" @ %Tools.Scripts),
	* "wrong default value" @ "%SHBuild_ToolDir"
		$effective @ (("%install-sysroot.sh" $since b546, ("%SHBuild-build.sh",
		"%SHBuild-bootstrap.sh", "%SHBuild-self-host.sh",
		"%SHBuild-self-host-DLL.sh") @ %Scripts $since b540) @ %Tools,
		"%test.sh" @ %Test $since b575)
		/ $= (/ $impl ^ '${BASH_SOURCE[0]}' ~ '$0'),
	/ "exposed overridable variable %SHBuild_ToolDir"
		$effective @ (("%install-sysroot.sh", ("%SHBuild-bootstrap.sh",
		"%SHBuild-self-host.sh", "%SHBuild-self-host-DLL.sh") @ %Scripts)
		@ %Tools, "%test.sh" @ %Test),
	(
	- DLI "shell path check with 'cd' and 'pwd' for embedded path components"
		$effective @ (("%GenerateProjects.sh, PatchRevision.sh, \
		SHBuild-BuildPkg.sh")
		@ %Tool.Scripts, "%test.sh" @ %Test, "%build-all.sh" @ %YDE);
		// Such cases should not fail because they are already assumed existing.
	/ "all shell path detection before 'pwd' ignored 'cd' error"
		$effective @ (("%(SHBuild-bootstrap.sh, SHBuild-common-options.sh, \
		shbuild-common-toolchain)") @ %Tool.Scripts, "%test.sh" @ %Test,
		"%build-all.sh" @ %YDE)
		// This prevents empty results being used if there is 'set +e'.
	)
),

b902
(
	/ %YBase.YStandardEx $=
	(
		/ DLI "simplified and optimized function template %extract#1" @ %String,
		+ "function template %flush_input" @ %StreamBuffer
	),
	/ %YFramework $=
	(
		/ %YCLib $=
		(
			/ %FileSystem $=
			(
				/ DLDI @ "platform %DS" @ "function %ReadLink#1" ^ 'yunused',
					// To eliminate G++ warning: [-Wunuwed-variable].
				* "wrong %FileTime conversion from %::time_t"
					@ !"platform %Win32" @ "functions %(GetFileAccessTimeOf, \
					GetFileModificationTimeOf, \
					GetFileModificationAndAccessTimeOf)" $orig (@
					"member %FileDescriptor::GetModificationTime" $since b624)
			),
			+ "function %StreamGet" @ %FileIO ^ $dep_from 
				("%ystdex::flush_input" @ %YBase.YStandardEx.StreamBuffer)
		),
		/ %YSLib.Adaptor $=
		(
			+ 'using platform::StreamGet;' @ %YAdaptor
				$dep_from ("%StreamGet" @ %YCLib.FileIO),
				// See $2020-10 @ %Documentation::Workflow.
			/ DLDI @ "class %Typeface" @ %Font $=
			(
				+ 'ynothrow' @ "internal bitmap data",
				/ "destructor" ^ "%ystdex::aligned_cast" ~ 'reinterpret_cast'
			)
		),
		/ %NPL $=
		(
			/ @ "function %LoadModule_SHBuild" @ %Dependency $=
			(
				* "missing basic hook adjustment" $since b901
					$= (/ $impl ^ "%REPLContext::GetOutputStreamRef"
						~ "%std::prinf"),
				/ "applicative %SHBuild_EchoVar returned '#inert'"
			),
			/ "base class %InvalidSyntax" @ "class %ParameterMismatch" @ %NPLA
				-> "%ListTypeError",
				// Now exceptions from %ThrowInsufficientTermsError \
					and %ListTypeError can be caught together.
			/ %NPLA1 $=
			(
				/ "function %ThrowValueCategoryError"
					-> "%ThrowValueCategoryError",
					// This is more general, although at current all the uses \
						are still for the cases of 1st argument.
				+ "function %ThrowListTypeErrorForNonlist",
				/ ThrowListTypeErrorForInvalidType
				* "missing check for list of arguments"
					@ "functions %(MatchParameter, BindParameter)"
					$orig (@ "function %BindParameter" $since b777)
					$= (/ "checked to throw %ListTypeError on failure"
						^ $dep_from "%ThrowListTypeErrorForNonlist"),
					// This is for the case like a parameter subterm '(.x)' \
						matching a non-list argument.
				/ DLI "avoided deprecated lambda capture '=' with implicit \
					'this'" @ "functions %(BindParamater, MatchParameter)"
					// To eliminate Clang++ 10 warning: \
						[-Wdeprecated-this-capture].
			),
			/ %NPLA1Forms $=
			(
				(
				/ $forced "removed 'for the 1st argument'" @ "error messages"
					@ "functions %(FirstAt, FirstRef, SetFirst, SetFirstAt, \
					SetFirstRef, SetRest, SetRestRef, CheckListReference)"
					$dep_from "%ThrowValueCategoryError";
				/ $comp "possible wrong 'for the 1st argument'"
					@ "message" @ "function %CheckListReference" $since b855
					// The corresponding applicative is for the general case, \
						rather than only for the 1st argument.
				),
				/ "removed 'for the 2nd argument" @ "exception message"
					@ "functions %(SetRest, SetRestRef)"
					^ $dep_from ("%ThrowListTypeErrorForNonlist" @ %NPLA1),
					// This is consistent to the change above. It also enables \
						the possibility to be reused with other cases.
				* $impl "redundant 'YF_API' on entity without external linkage"
					$since b899 $dep_to "Clang++ compiling error"
					// Also to prevent Clang++ error.
			)
		),
		* $re_add(b896) "wrong 'YB_NONNULL(1)'" @ ("lambda-expression"
			@ "platform %Win32" @ "function %uremove" @ %FileSystem $orig
			(@ %FileIO $since b639), "member function %DirectoryFindData::Read"
			@ %'YCLib_(Win32)'.MinGW32 $since b701)
			$dep_to "Clang++ compiling error"
			$= (/ $impl 'YB_NONNULL(1)' -> 'YB_NONNULL(2)')
			// Also to prevent Clang++ error.
	),
	/ %Tools $=
	(
		/ "improved basic terminal hook and string printing" @ %SHBuild.Main
			^ "%(std::cout, YSLib::IO::StreamPut, ystdex::write_literal)"
			~ "%std::(printf, puts)",
			// See $2020-10 @ %Documentation::Workflow.
		/ %Scripts $=
		(
			(
			- "%AR setting" @ "%SHBuild-common-options.sh",
			+ "default value" @ "%AR" @ "%SHBuild-common-toolchain.sh"
				^ "detection";
			/ @ "%SHBuild-BuildApp.sh" $=
			(
				- "%AR setting";
				* "%AR overriden from the environment not used"
					$orig (@ "%SHBuild-appconf.sh" $since b546)
			)
			),
			/ "Clang++ detection" @ "%SHBuild-BuildApp.txt"
				^ "%SHBuild_CheckCXX" ~ 'rmatch?',
				// This is more accurate, but a bit inefficiet.
			/ "improved thread detection and distinguished thread flags \
				for %CXXFLAGS and %LDFLAGS" $=
			(
				// MinGW Clang++ supports '-mthreads' at the linker command, \
					but not the compiler command.
				/ "improved detection" @ "%SHBuild-common-toolchain.sh",
				/ @ "%SHBuild-YSLib-common.txt" $=
				(
					/ "functions ('get-thread-option', \
						'get-thread-option-silent')
						-> ('get-thread-options', 'get-thread-options-silent');
					* $comp "thread flags detection"
						$orig (@ "%SHBuild-common-toolchain.sh" $since b791)
						// This was not consistent to the original \
							%SHBuild-common-options.sh since then.
				);
				/ "default value" @ "%LDFLAGS" ^ "thread-specific flags"
					@ "(%SHBuild-common-toolchain.sh, \
					SHBuild-YSLib-common.txt)";
				- "redundant system library option '-lpthread'"
					$effective @ ("%(SHBuild-BuildApp.sh, \
					SHBuild-BuildApp.txt, SHBuild-YSLib-build.txt)")
			),
			/ "improved support for LLVM-based toolchains"
				@ "%(SHBuild-common-toolchain.sh, SHBuild-YSLib-common.txt)"
				$=
			(
				/ "refined options to supported LLD as the linker";
				+ "stub to enable LLD for Clang++" @ "platform %Win32"
			),
			/ @ "%SHBuild-YSLib-common.txt" $=
			(
				+ "%AR detection",
					// This is consistent with %SHBuild-common-toolchain.sh.
				+ "'lib' prefix" @ "installed import library names",
					// This already works without the prefix. Now the names \
						are more consistent to Cygwin and MSYS2.
				/ "simplified" @ "%LD not used in the command" $=
				(
					/ "disabled showing %LDFLAG";
					/ DLI "disabled unused 'LDFLAGS*' and 'LIBS*' settings"
				),
				+ "real import library installation support"
					// See $2020-11 @ %Documentation::Workflow.
			),
			/ @ "%SHBuild-YSLib-build.txt" $=
			(
				/ DLDI "simplified 'system-quote' with 'SHBuild_2m' calls",
				/ "YSLib libraries building" $=
				(
					/ DLDI "removed unused %LIBS restoring",
					* $re_add(b838) "possibly missing quotes on '-L' argument \
						of output directory on the %LIBS environment"
						$since b796 ^ 'system-quote',
					+ "import library generation",
					* "missing compiler check" @ "workaround specific for G++"
						$since b900
						// The option '-fno-var-tracking-assignments' is not \
							compatible to Clang++.
				),
				/ $forced DLDI "library installation"
					$dep_from ("real import library installation support"
					@ "%SHBuild-YSLib-common.txt")
					// See $2020-11 @ %Documentation::Workflow.
			),
			/ "disabled LTO for Clang++" @ "%(SHBuild-YSLib-common.txt, \
				SHBuild-common-options.sh)" $dep_to "cross-compiler ABI fix",
				// LLD seems the only option to recognize the LLVM bitcode, \
				but the final linking still does not work. Note this is \
				directly fixed in the common scripts.
			(
			/ DLI "simplified quotes in path not following ','"
				^ "simplified 'system-quote' with 'SHBuild_2m' calls"
				$effective @ "%(SHBuild-YSLib-build.txt, SHBuild-Buildapp.txt)";
			* $comp "wrong normalization of path" @ "%LIBS"
				@ "%SHBuild-BuildApp.txt"
				$orig (@ "%SHBuild-BuildApp.sh" $since b563)
			),
			* $comp "wrong normalization of path" @ "%LIBS"
				@ "%SHBuild-BuildApp.sh" $since b563
				(/ $impl ^ 'SHBuild_2m' ~ 'SHBuild_2w')
		)
	),
	(
	* "missing fat LTO object support" @ "%(Makefile.mingw, Makefile.gnu)"
		@ "%3rdparty/FreeImage" $since b900;
	/ $forced "rebuilt library %FreeImage for %release configurations"
		@ "platform %(MinGW32, MinGW64, Linux)" $dep_to "cross-compiler ABI fix"
	),
	* $comp "Clang++ build issues" $since b639 $=
	(
		* "Clang++ compiling error" @ "platform %Win32" $since b639,
		* $comp "Clang++ linking broken" $since b900
			$dep_all_from "cross-compiler ABI fix",
			// Currently fat LTO objects are the only way to support both G++ \
				and Clang++ with probably partial LTO support in some \
				confiugrations.
	),
	/ "make %C_LTO overridable" $effective @ "all makefiles"
		@ "%3rdparty/FreeImage",
	/ @ "%SHBuild-YSTest.sh" @ "project %YSTest" $=
	(
		/ "checked %SHBuild_BuildDir to override application base directory"
		/ "checked %SHBuild_SystemPrefix and %SHBuild_SysRoot to set and \
			export %SHBuild_Bin"
			// This allows overriding of %$SHBuild_SysRoot to determine \
				different Sysroot directory and build directory being used.
	)
),

b901
(
	/ %YBase.YStandardEx $=
	(
		+ $re_ex(b178) $dev $lib "#pragma directive"
			@ 'YB_IMPL_GNUCPP >= 100000' @ "metafunction \
			%have_common_nonempty_virtual_base" @ %TypeOperation,
			// To eliminate G++ 10 warning: [-Winaccessible-base].
		/ %Path $=
		(
			/ @ "class template %path_traits" $=
			(
				(
				+ "specialization for %basic_string_view instantiations";
				/ "simplified specialization for %basic_string  instantiations",
				),
				+ $dev $lib 'YB_ATTR_nodiscard'
					@ "all static memeber functions"
			),
			+ "function template %is_parent_or_self"
		),
		* "missing check exceptions mask"
			@ "function template %rethrow_badstate" @ %IOS $since b663,
		/ %String $=
		(
			/ DLI @ "function templates %write" $=
			(
				/ "overload %write#1"
					-> "3 function templates without default arguments",
					// This is more efficient.
				- "overload for arrays",
					// This should be already covered by other overloads.
				/ $impl "all 'class _tString'" -> 'typename _tString'
					// The string objects of array type are also supported \
						uniformly.
			),
			(
			* "missing inclusion %CString" @ 'YB_Has_string_view == 1'
				$since b833;
			+ "function template %write_ntcts"
			),
			/ DLDI "sentry" @ "function template %extract#1"
				^ "direct initialization"
		)
	),
	/ %YFramework $=
	(

		* "missing 'inline'" @ "namespace %Android" @ ".cpp file"
			@ %'YCLib_(Android)'.Android $since b492,
			// Also to eliminate Clang++ warning.
		* "missing return value" @ "branch traversal"
			@ "constructor %DEntry#5" @ %'YCLib(DS)'.DSIO $since b900,
			// Also to eliminate G++ warning: [-Wno-unused-result].
		/ %'YCLib(Win32)'.MinGW32 $=
		(
			+ "2 functions %ParseCommandArguments",
				// See $2020-10 @ %Documentation::Workflow.
			* "missing 'YF_API'"
				@ "functions %(LockFile, TryLockFile, UnlockFile)",
			+ $dev $lib 'YB_ATTR_nodiscard' @ "all functions with non-void \
				return type and without 'YF_ATTR_nodiscard' other than \
				declared by 'Def*' or %(DirectoryFindData::Read, UnlockFile)",
			+ $dev $lib 'YB_PURE' @ ("functions %(Win32Exception::( \
				GetErrorCategory, FormatMessage), CategorizeNode#4)",
				$impl "internal error category member functions")
		),
		/ %YCLib $=
		(
			+ "class name declaration %FileDescriptor" @ %FileSystem,
			/ %FileIO $=
			(
				/ ("all functions %(uaccess, ugetcwd, uchdir, umkdir, urmdir, \
					uunlink, uremove)",
					"function template %FetchCurrentWorkingDirectory and its \
					specializations") >> %FileSystem,
				(
				/ "member functions %FileDescriptor::(GetAccessTime, \
					GetModificationTime, GetModificationAndAccessTime, \
					SetAccessTime, SetModificationTime, \
					SetModificationAndAccessTime)" -> "functions \
					%(GetFileAccessTimeOf, GetFileModificationTimeOf, \
					GetFileModificationAndAccessTimeOf, SetFileAccessTimeOf, \
					SetFileModificationTimeOf, \
					SetFileModificationAndAccessTimeOf)";
				/ "all functions ('SetFile*TimeOf, 'GetFile*TimeOf'))"
					>> %FileSystem $dep_from ("%FileDescriptor" @ %FileSystem)
				),
				(
				/ "member function %FileDescriptor::GetNumberOfLinks"
					-> "function %FetchNumberOfLinks";
				/ "all functions %FetchNumberOfLinks"
					>> %FileSystem $dep_from ("%FileDescriptor" @ %FileSystem)
				),
				(
				+ 'ynothrow' @ "%operator(==, !=) for %FileNodeID",
				/ "member function %FileDescriptor::GetNodeID"
					-> "function %GetFileNodeIDOf";
				/ "type %NodeID"; "functions %operator(==, !=) for %NodeID",
					"functions %(GetFileNodeIDOf, IsNodeShared)"
					>> %FileSystem
				),
				+ "function %StreamPut" $dep_from (%YBase.YStandardEx.IOS,
					"%ystdex::write_ntcts" @ %YBase.YStandardEx.String)
			),
			/ @ "platform %Win32" @ %NativeAPI $=
			(
				* "'__has_include(<specstrings_undef.h>)' broke Visual C++ \
					builds" $since b900
					$= (/ "commented out the check"),
				/ @ "namespace %platform_ex" $=
				(
					+ "function %IntPtrToHandle";
					+ "check for special invalid return value '-2'"
						@ "function %ToHandle"
						// This is not a bug since the special value is \
							documented recently. Note the earliest \
							implementation in this project dates back to b475 \
							in %YCLib.FileSystem.
				)
			)
		),
		/ %YSLib $=
		(
			/ @ "namespace %YSLib::IO" @ %Adaptor.YAdaptor $=
			(
				+ 'using platform::FileTime;',
				+ 'using platform::SetFileAccessTimeOf;'
					$dep_from ("%FileDescriptor::SetAccessTime" @ %FileIO),
				+ 'using platform::SetFileModificationTimeOf;' $dep_from
					("%FileDescriptor::SetModificationTime" @ %FileIO),
				+ 'using platform::SetFileModificationAndAccessTimeOf;'
					$dep_from
					("%FileDescriptor::SetModificationAndAccessTime"
					@ %FileIO),
				+ 'using platform::StreamPut;'
					$dep_from ("%StreamPut" @ %FileIO)
			),
			* $forced DLDI "object definitions %(PreserveModificationTime, \
				PreserveModificationAndAccessTime)" @ %YSLib.Service.FileSystem
				$dep_from ("%FileDescriptor" @ %YCLib.FileIO)
				$= (/ $impl ^ "%(SetFileModificationTimeOf, \
					GetFileModificationTimeOf, \
					SetFileModificationAndAccessTimeOf, \
					GetFileModificationAndAccessTimeOf)"
					$dep_from %YAdaptor.Adaptor)
		),
		/ %NPL $=
		(
			+ "common reducer name" @ "functions %(AccR, FoldR1, Map1)"
				^ "%A1::NameTypedReducerHandler" @ %NPLA1Forms,
			/ %NPLA1 $=
			(
				/ DLDI
					"simplified member function %Continuation::GetNextTermRef",
				/ @ "class %REPLContext" $=
				(
					+ "data member %OutputStreamPtr";
					+ "function %GetOutputStreamRef"
				)
			),
			/ "applicative %puts" @ "function %LoadModule_std_io" @ %Dependency
				^ ($dep_from "%REPLContext::GetOutputStreamRef" @ %NPLA1,
				"%YSLib::IO::StreamPut" @ %YSLib.Adaptor.YAdaptor)
				~ "%std::puts"
				// This hack makes it possible to work for priting Unicode BMP \
					codepoints from a UTF-8 input on the traditional (broken) \
					Windows console in %MinGW32 platforms when libstdc++ is \
					used, though it still chokes from the console input;
		)
	),
	/ %Tools $=
	(
		/ %Scripts $=
		(
			/ "relocated installed NPLA1 scripts to 'share/NPLA1'" ~ 'var/NPLA1'
				@ %SHBuild-build-YSLib.txt,
				// This should be better read-only.
			/ DLDI "renamed internal path prefix variable for loading"
				// Ditto, but actually not sensitive to the actual behavior, \
					as the loaded script %SHBuild-YSLib-common.txt is still in \
					the same directory to %SHBuild-BuildApp.txt.
		),
		/ %SHBuild.Main $=
		(
			/ $forced DLI "registered %std::cout as the output stream"
				@ "NPLA1 context initialization"
				$dep_from %YFramework.NPL.Dependency,
			* "wrong ANSI code page assumptions on handling external command \
				arguments" @ "platform %Win32" $since b476
				$= (/ $impl ^ "%platform_ex::ParseCommandArguments"
					~ "%platform_ex::(EncodeArg, DecodeArg)")
					// See $2020-10 @ %Documentation::Workflow.
		)
	),
	/ DLI "optimized dot strings comparision"
		^ $dep_from ("%ystdex::is_parent_or_self" @ %YBase.YStandardEx.Path)
		$dep_from ("ystdex::path_traits specialization for %basic_string_view \
		instantiations" @ %YBase.YStandardEx.Path)
		$effective @ ("constructors#(4, 5)", "function %IsDot")
		@ "class %DEntry" @ %'YCLib_(DS).DSIO'
		// This is in general more efficient than comparing to string literals \
			more than 3 by times when dot and dot-dot string are all compared \
			(also having significantly improving in a string string comparison).
),

b900
(
	/ $re_add(b826) DLB "removed targets generated from 'objcopy -O binary'"
		@ "makefile" @ "project %YSTest_ARM9" @ "platform %DS",
		// This is not used since b826. See $2018-05 @ %Documentation::Workflow.
	/ $re_ex(b800) "updated year" @ "%SUBTITLE2" @ "makefile" @ "platform %DS"
		@ "project %YSTest",
	/ %YFramework $=
	(
		/ @ "platform %DS" @ %'YCLib_(DS)'.DSIO $=
		(
			/ @ "member function %Partition::StatFromEntry" $=
			(
				/ "removed assignments to implementation-specific 'st_spare*' \
					data members" $dep_to "newlib compatibility",
					// This is also compatible to newlib > 3.1.
				/ "set .tv_nsec to 0" @ 'st_*time'
					@ "newlib version greater than 3.1"
					// See also https://github.com/devkitPro/libfat/issues/19.
			),
			/ "read FSInfo for FAT32 unconditionally"
				@ "member function %Partition::StatFS"
				~ "creation of FSInfo on the special 'SCAN' command magic",
				// Same to https://github.com/devkitPro/libfat/commit/42fe5af38d0d48a1a3a874c96ee89ecb62f7a4a1.
			/ $dev "type of all free count value" ^ $dep_from
				("%ClusterCount" @ "namespace %FAT" @ %FileSystem) ~ "%size_t",
			+ DLDI 'YB_ATTR_nodiscard' @ "internal functions",
			/ @ "class %AllocationTable" $=
			(
				(
				+ "function %UpdateFSInfo";
				+ "function %SynchronizeClusters" ^ $dep_from
					("%FAT::Clusters::UnknownFreeCount" @ %YCLib.FileSystem)
				),
				- "function %WriteFSInfo" $dep_from "%Partition::CreateFSInfo",
				- "function %ReadClusters"
					$dep_from "%Partition::SynchronizeClusters",
				+ $dev $lib 'YB_ATTR_nodiscard' @ "functions %(QueryNext, \
					QueryLast, LinkFreeCleared, CountFreeCluster, TrimChain)",
				+ $dev $lib 'YB_ATTR_nodiscard YB_PURE'
					@ "function %IsFreeOrValid",
			),
			+ $dev $lib 'YB_ATTR_nodiscard YB_PURE'
				@ ("functions %IsFATRoot16Cluster",
				"friend function %operator==") @ "class %DEntryPosition",
			/ @ "class %Partition" $=
			(
				/ DLDI "simplified function %CreateFSInfo"
					^ $dep_from "%AllocationTable::UpdateFSInfo"
					~ "%AllocationTable::WriteFSInfo",
				/ "updated FSInfo on reading" @ "function %ReadFSInfo"
					^ $dep_from "%AllocationTable::SynchronizeClusters"
					~ "%AllocationTable::ReadClusters",
					// Same to https://github.com/devkitPro/libfat/commit/42fe5af38d0d48a1a3a874c96ee89ecb62f7a4a1.
				/ "consolidated MBR sector check" @ ("constructor#2",
					"function %FindFirstValidPartition") ^ $dep_from
					("%(CheckValidMBR, MatchSignature)" @ "namespace %FAT"
					@ %YCLib.FileSystem),
					// Different to LibFAT 1.1.2. See the comments in the source
					//	code for details.
				+ DLDI 'YB_ATTR_nodiscard' @ "private function",
				+ $dev $lib 'YB_ATTR_nodiscard' @ "functions %(EntryExists, \
					ExtensionResult, LockOpenFiles, ReadFSInfoSector, \
					ReadSector, WriteSector)",
				/ DLI "cached file system type by initialization of cluster \
					reader"
					$= (/ "function %ReadClusterFromEntry" -> "data member")
			),
			/ @ "member function %DirState::Iterate" $=
			(
				/ "throwing" -> "return value %int";
					// This now follows the corresponding change in \
						https://github.com/devkitPro/libfat/pull/9. Note there \
						is no need to change elsewhere, as the %::devoptab_t \
						handler is already self adapted to both cases.
				+ $dev $lib 'YB_ATTR_nodiscard'
			),
			/ $dev $lib @ "class %FileInfo" $=
			(
				+ 'YB_ATTR_nodiscard YB_PURE'
					@ "functions %(CanAppend, CanRead, CanWrite)"
				+ 'YB_ATTR_nodiscard' @ "function %(Read, Seek, Write)"
			),
			+ $dev $lib 'YB_ATTR_nodiscard'
				@ "functions %(FetchPartitionFromPath, Mount, Unmount)",
			+ "function %IsSimpleAbsolute",
			/ @ "class %DEntry" $=
			(
				(
				+ "function %IsFAT32Root";
				/ "split constructor %DEntry#4" -> "2 constructors"
					^ ($dep_from "%IsSimpleAbsolute", "%IsFAT32Root")
					$dep_to "DEntry constructor split";
				/ $comp DLDI "avoided unused variable"
					@ "release configurations"
					@ "constructor %DEntry with 5 parameters" ^ 'yunused',
					// To eliminate G++ warning: [-Wunused-variable].
				),
				+ "default move (constructor, %operator=)",
					// To avoid unexpected copies.
				+ 'const' @ "parameter" @ "constructor#1"
			),
			/ $forced DLDI "simplified (member function %Partition::ChangeDir, \
				constructor %DirState)" $dep_from "DEntry constructor split",
			+ DLD "2 'nullptr' at end of %devoptab_t object"
				$dep_from "devkitARM update"
				// To eliminate G++ warning: [-Wmissing-field-initializers].
		),
		/ %YSLib $=
		(
			+ $dev $lib "friend functions %operator(==, <)" @ "class %Path"
				@ %Service.FileSystem,
				// Also to eliminate G++ 7.1 warning: \
					[-Wsuggest-attribute=pure].
			/ DLDI "%std::forward_as_tuple" -> "%YSLib::forward_as_tuple"
				$effective @ %Core.(YMessage, YEvent),
			/ DLDI "%std::tuple" -> "%YSLib::tuple" $effective @ %Core.YEvent,
			* "missing overrider %get" @ "class templates \
				%(PolymorphicValueHolder, PolymorphicAllocatorHolder)"
				$since b899
		),
		/ %YCLib $=
		(
			/ %FileSystem $=
			(
				/ DLDI "cast to 'std::wint_t'" @ "function template \
					%FetchRootNameLength_P#(3, 4)",
					// To eliminate G++ 7.1 warning: [-Wsign-conversion].
				/ @ "namespace %FAT" $=
				(
					(
					+ "alias %ClusterCount";
					+ "static yconstfn object %UnknownFreeCount"
						@ "namespace %Clusters"
					),
					(
					+ "static yconstfn object %FATSignature";
					+ "function %MatchSignature";
					+ "function %CheckValidMBR"
					),
					+ $dev $lib 'YB_ATTR_nodiscard'
						@ ("functions %(ConvertFileTime, FetchDateTime, \
						ConvertToAlias, FetchLongNameOffset, ConvertToMBCS, \
						GenerateAliasChecksum, ValidateName)", "functions \
						%(FindAlias, GenerateAlias)" @ "class %EntryData")
				),
				+ $dev $lib 'YB_ATTR_nodiscard' @ ("all 2 functions \
					%(IsDirectory, ReadLink)",
					"function %GetNativeName" @ "class %HDirectory")
			)
			+ DLB "workaround to prevent reserved identifier %__deref clash"
				@ "platform %Win32" @ %YCLib.NativeAPI,
				// Without the workaround, %__deref in libstdc++ <functional> \
					of G++ 10.2 in debug mode (with %_GLIBCXX_DEBUG defined) \
					clashes with macro (defined empty) from MinGW-w64's \
					<sal.h>. See https://gcc.gnu.org/bugzilla/show_bug.cgi?id=97362.
			* $comp $build "%_POSIX_C_SOURCE check failed" @ %Platform
				@ "platform %Android" $since b894
				$dep_from ("%Toolchain.Android.mk" @ %Tools.Scripts)
		),
		/ %NPL $=
		(
			* "assertion failure for terms of leaf nodes caused by missing \
				%IsBranchedList check" @ "functions %Forms::(FoldR1, Map1)"
				@ %NPL.NPLA1Forms $since b899,
			+ "applicative %SHBuild_DirectoryOf_"
				@ "function %LoadModule_SHBuild" @ %Dependency
		)
	),
	/ DLP "toolchain and library using" $=
	(
		/ $re_ex(b800) "platform %MinGW32 toolchain"
		(
			^ "MinGW[gcc version 10.2.0 (Rev3, Built by \
				MSYS2 project)] mingw32/mingw-w64-i686-gcc-10.2.0-3"
				~ "MinGW[gcc version 7.1.0 (Rev2, Built by MSYS2 project)] \
				mingw32/mingw-w64-i686-gcc-7.1.0-2" @ "platform %MinGW32"
				$dep_from %YFramework.YCLib.NativeAPI,
				// Unchanged: Target=i686-w64-mingw32, Thread model: posix, \
					Exceptions implementation: Dwarf2.
			^ $re_ex(b800) "mingw-w64-i686-binutils 2.35-1 from MSYS2"
				~ "mingw-w64-i686-binutils 2.28-2";
			/ $forced "rebuilt library %FreeImage";
				// If seems not working without rebuilding even with the old \
					library binary, as the linking would fail in %release \
					configurations.
			/ $forced "disabled LTO by adding '-flto'"
				@ "static release configuration" @ "platform %MinGW32"
				// To work around linking failure.
		),
		/ $re_ex(b826) DLP @ "platform %DS" $=
		(
			(
			^ "updated devkitARM release 55" ~ "devkitARM release 48"
				$dep_to "devkitARM r55" $dep_from "newlib compatibility"
				$dep_to "devkitARM update";
			/ $forced "rebuilt library %freetype"
				// If seems not working without rebuilding even with the old \
					library binary, as the font loading would always fail \
					(though the %FT_Library initialized without errors).
			),
			^ "updated libnds 1.8.1" ~ "libnds 1.7.2"
			// The final .nds file bloats from 979 KiB to 1003 KiB, and new \
				changes on %'YCLib(DS)_DSIO' makes more 1 KiB.
		),
		(
		/ DLP "updated platform %Linux toolchain",
		/ @ "%3rdparty/FreeImage" $=
		(
			* "missing local inclusion directory" @ "assembler command"
				@ "makefiles with %asm rules" @ $since b885,
				// This is at least necessary for %NASM, which is default in \
					%Makefile.gnu.
			(
			/ $doc "%Readme.en-US.txt" -> "%Readme.en-US.md";
			/ $doc "clarified the library file location" @ "platform %Linux"
				@ "%Readme.en-US.txt",
			)
			/ DLI "replaces space to tabs" @ "%Makefile.mingw"
				// In this context it does not have undesired effects.
			/ @ "makefile" @ "plaform %DS" $=
			(
				/ "renamed %MODULE";
				+ "rules for '%.c' and '%.cpp'";
				+ '.SUFFIXES:'
			),
			(
			+ "variables %(CC, CXX, LD) with default value" @ "%Makefile.gnu";
			+ $doc "'-R' in make commands" @ $dep_from "%Readme.en-US.md",
				// For some reasons, 'MAKEFLAGS += -R' in makefiles does work; \
					it just wipes out any default variables in spite of '?='.
			* "misspelled 'C_CXXFLAGS' as 'C_CXX_FLAGS'" $effective
				@ "%(Makefile.gnu, Makefile.mingw)" $since b562;
				// This does work only in %Makefile.gnu, because all instances \
					in %Makefile.mingw are wrong.
			(
			* "missing set %AR as 'gcc-ar' by default" @ "makefiles"
				$since b562,
			+ "%debug library builds with 'CONF=debug' and expected used the \
				output library file as %lib/libFreeImaged.a"
				$dep_to "libFreeImaged";
				// See $2020-10 @ %Documentation::Workflow.
			* "missing '-flto'" @ "default value of" @ "%C_CXXFLAGS"
				$since b562
				// See $2020-10 @ %Documentation::Workflow.
			)
			)
		);
		/ "rebuilt library %FreeImage" @ !"platform %Android"
		),
		/ "updated library %freetype" @ "library using" $=
		(
			+ "empty file %3rdparty/freetype/src/smooth/ftspic.h",
				// Used by the old %ftgrays.c.
			+ "%3rdparty/freetype/include/ftcolor.h from freetype 2.10.2",
				// Used by %FT_BITMAP_H.
			(
			/ $doc "%Readme.en-US.txt" -> "%Readme.en-US.md";
			/ $doc "updated build command for plaform %Win32"
				// See the %Readme.en-US.md document.
			),
			+ 'CPPFLAGS += -DFT_CONFIG_MODULES_H="<ftmodule.h>"'
				@ "%3rdparty/freetype/builds/ds/build.mk";
				// Ditto.
			^ $re_ex(b700) "updated freetype 2.10.2 with several files \
				remained from freetype 2.4.11" ~ "freetype 2.9.1";
			/ "rebuilt library %freetype" @ "platforms %(DS, MinGW32)"
			// See [Documentation::Dependencies @@2.2.6].
		)
	),
	/ %Tools.Scripts $=
	(
		+ '-D_POSIX_C_SOURCE=200809L' @ "%C_CXXFLAGS_COMMON"
			@ "%Toolchain.Android.mk",
		/ $forced "supported '-lFreeImaged'" @ "%SHBuild-BuildApp.sh"
			$dep_from "libFreeImaged"
			$= (+ $dev "overridable variable %SHBuild_YF_Libs_FreeImage"),
		* "wrong leading '/' on default value" @ "variable \
			%SHBuild_YF_CFlags_freetype when 'pkg-config' failed"
			@ !"platform %Win32" @ "%SHBuild-BuildApp.sh" $since b885,
		/ @ "%SHBuild-YSLib-common.txt" $=
		(
			* "missing import 'string->symbol' from 'std.strings'" $since b840,
				// %SHBuild-YSLib accidentally works because it imports \
					'string->symbol'.
			* "missing import %SHBuild_TrimOptions_ from %env_SHBuild_"
				$since b838,
				// Ditto.
			* DLDI "wrong handling of negation %SS_Debg" $since b840,
				// This did not expose wrong behavior because the consumption \
					of the value is also wrong.
			* @ "applicative 'ss-verbose-puts'" $since b840 $=
			(
				* "wrong handling of negation %SS_Verbose",
				* "missing copying the variable to the static environment"
			),
			(
			/ DLDI "simplfied 'chmod' invocation";
			/ "avoid 'chmod' command invocations" @ "platform %Win32";
			* "missing invoking 'chmod' on executables"
				@ "applicative %InstSHBuild" $since b838
			)
		),
		/ "%MSYSTEM wrongly applied to non-Windows host environments"
			@ "function %SHBuild_Platform_Detect" @ "%(SHBuild-common.sh, \
			SHBuild-YSLib-common.txt)" $mismath $since b885,
			// %MSYSTEM can be defined natually in other environments, e.g. WSL.
		(
		+ "NPLA1 script %SHBuild-BuildApp.txt"
			$dep_from ("%SHBuild-YSLib-common.txt", %YFramework.NPL.Dependency);
		+ "shell script %SHBuild-BuildPkg.sh"
		),
		/ @ "%SHBuild-YSLib-build.txt" $=
		(
			+ $forced "libFreeImaged support" $dep_from "libFreeImaged",
			/ "checked %(SHBuild_UseDebug, SHBuild_UseRelease)"
				@ "3rdparty library installation",
			+ $re_add(b885) $re_ex(b897) "'-gdwarf-3' as workaround after '-Og'"
				@ "platform %MinGW64" @ "YFramework DLL build",
				// See $2020-10 @ %Documentation::Workflow.
			* "missing restoring %LIBS before %YBase build" $since b796,
				// This makes dynamic library in %release configuration having \
					polluted %LIBS by the %debug configuration of YFramework \
					(so YBase release dynamic library would be then linked to \
					YBase debug dynamic library) when both %debug and \
					%release configurations are enabled in the same script run.
			* "missing restoring %LIBS before stage 2 %SHBuild build"
				$since b838,
				// Ditto, although this is only bad when after a debug-only \
					build of YBase + YFramework if YBase dynamic library are \
					built correctly.
			(
			+ $deploy "installing directory %var/NPLA1 under SysRoot";
			/ "NPLA1 module directory" -> "%var/NPLA1" ~ "%bin";
			+ $deploy "installing new files" @ !"%SHBuild_NoDev"
				$dep_from "%(SHBuild-BuildApp.txt, SHBuild-BuildPkg.sh)"
			),
			+ $build "options '-O1 -g -fno-var-tracking-assignments' as \
				workaround"
				@ "%YFramework static library build" @ "configuration% debug"
				@ "platform %MinGW64" -> '-O1'
				// See $2020-10 @ %Documentation::Workflow.
		)
	),
	/ $re_ex(b800) "regenerated Code::Blocks projects"
		^ ("%GenerateProjects.sh" @ %Tools.Scripts),
	/ $doc "%Doxyfile" $=
	(
		/ $deploy "updated version";
		/ DLDI "saved with some new default configurations"
	)
);

////

